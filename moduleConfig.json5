// This file is used to configure various modules and common settings.

{
    // General settings that apply to all modules and drone core settings.
    "common": {
        "droneId": "B3B5B828AACE",
        //"livekitUrl": "wss://misison-control-test-7te1qygb.livekit.cloud",
        "livekitUrl": "wss://expeditionx-zpuob57u.livekit.cloud",
        "platformUrl": "https://mission-control-sigma.vercel.app",
        "droneStreamPath": "api/stream.mjpeg?src=camera1",
        "droneStreamPort": "1984",
        "macAddress": "2c:cf:67:db:b9:15",

        "websocket": { // Only SSL now
            "cert": "ssl/server.crt",
            "key": "ssl/server.key"
        },
        "drone": {
            "centerOfMass": [0, -1.3901, -9.9135], // [sway/pitch, heave/yaw, surge/roll] in 3D Viewer
            "leds":{
                "right": [-1.5621, -5.3706, -9.114],
                "middle": [0, -5.5562, -9.277],
                "left": [1.5621, -5.3706, -9.114],
            },
            "camera": [0, 0, 0],
        },
        "pca9685": {
            "enabled": false,
            "i2cBus": 1, // RaspberryPi_5B
            //"i2cBus": 4, // OrangePi_5
            "i2cAddr": "0x40",
            "frequency": 526,
        },
        "motors": {
            "Front-Right Wing": {
                "gpioOutPWM": 6,
                "gpioOutReverse": 7,
                "position": [-10.5422, 3.8843, -5.303],
                "orientation": [0, 0.9961946980917455, 0.08715574274765817], // [0, cosd(5), sind(5)]
            },
            "Front-Left Wing": {
                "gpioOutPWM": 4,
                "gpioOutReverse": 5,
                "position": [10.5422, 3.8843, -5.303],
                "orientation": [0, 0.9961946980917455, 0.08715574274765817], /// [0, cosd(5), sind(5)]
            },
            "Back-Right Wing": {
                "gpioOutPWM": 2,
                "gpioOutReverse": 3,
                "position": [-10.5422, 3.8843, -24.697],
                "orientation": [0, 0.9961946980917455, -0.08715574274765817], // [0, cosd(5), -sind(5)]
            },
            "Back-Left Wing": {
                "gpioOutPWM": 0,
                "gpioOutReverse": 1,
                "position": [10.5422, 3.8843, -24.697],
                "orientation": [0, 0.9961946980917455, -0.08715574274765817], // [0, cosd(5), -sind(5)]
            },
            "Rear": {
                "gpioOutPWM": 8, // [OrangePi_5.pwm(OrangePi_5.bcm.GPIO1_A3, 1, 500),
                "gpioOutReverse": 9,
                "gpioOutStop": 12, // [OrangePi_5.output(OrangePi_5.bcm.GPIO1_A4),
                "invertPWM": true,
                "invertRotationDirection": false,
                "invertPWMWithDirection": false,
                "position": [0.00, 0.00, -29.2303],
                "orientation": [0, 0, 1], // Right-hand rule (Z forward)
            },
        }
    },

    // Module-specific settings.
    "stats": {
        "server": {},
        "client": {}
    },
    "media": {
        "server": {
        },
        "client": {
        }
    },
    "lights": {
        "server": {
            "enabled": true,
            "pca9685": {
                "leds": {
                    "vis": 13,
                    "ir": 14,
                    "uv": 15
                }
            }
        },
        "client": {}
    },
    "control": {
        "server": {
            "enabled": true,
        },
        "client": {}
    },
    "angle": {
        "server": {},
        "client": {}
    },
    "imu": {
        "server": {
            "enabled": true,
            "bno085": {
                // "i2cBus": 3, // RaspberryPi_4B
                // "i2cBus": 1, // OrangePi_5
                "i2cBus": 1, // RaspberryPi_5B
                "i2cAddr": "0x4b",
                "useInterrupts": true,
                // From opengpio library use device-specific bcm pin names.
                //"interruptPin": ["RaspberryPi_4B", "GPIO23"],
                //"interruptPin": ["OrangePi_5", "GPIO1_D2"],
                "interruptPin": ["RaspberryPi_5B", "GPIO23"],
            }
        },
        "client": {}
    },
    "battery": {
        "server": {
            "enabled": true,
            "simulated": true,
            "cellCapacity": 2550, // mAh
            "cellsInSeries": 2,
            "cellsInParallel": 3,
            "ina226": {
                "i2cBus": 1, // RaspberryPi_5
                // "i2cBus": 5, // OrangePi_5
                "i2cAddr": "0x40",
                "shuntResistorOhms": 0.01
            }
        },
        "client": {}
    },
    "tof": {
        "server": {
            "enabled": false,
            "vl53l5cx": {
                // "i2cBus": 1, // RaspberryPi_4B
                // "i2cBus": 4, // OrangePi_5
                "i2cBus": 2, // RaspberryPi_5B
                "i2cAddr": "0x29",
                "rangingFrequency": 5
            }
        },
        "client": {}
    },
    "spatial": {
        "server": {},
        "client": {
            "uiMarkers": {
                "surgeBillboard": [0, -1, -3],
                "rollBillboard": [0, 1.8, 0],
                "pitchBillboard": [0, -0.5, -1],
                "yawBillboard": [-1.2, 0.4, -1.5],
                "rightWingFront": {
                    "position": [-10.5422, 3.8843, -5.303],
                    "orientation": [0, 0.9961946980917455, 0.08715574274765817], // [0, cosd(5), sind(5)]
                },
                "leftWingFront": {
                    "position": [10.5422, 3.8843, -5.303],
                    "orientation": [0, 0.9961946980917455, 0.08715574274765817], // [0, cosd(5), sind(5)]
                },
                "rightWingRear": {
                    "position": [-10.5422, 3.8843, -24.697],
                    "orientation": [0, 0.9961946980917455, -0.08715574274765817], // [0, cosd(5), -sind(5)]
                },
                "leftWingRear": {
                    "position": [10.5422, 3.8843, -24.697],
                    "orientation": [0, 0.9961946980917455, -0.08715574274765817], // [0, cosd(5), -sind(5)]
                },
            }
        }
    }
}
